namespace: digital-wallet
# Configmap #
configmap:
  name: digital-assets-onboarding-configmap
  enabled: true
  data:
    application-dev.properties: |
      server.port=8091
      server.servlet.context-path=/digital-assets/onboarding
      spring.application.name=digital-assets-onboarding
      spring.threads.virtual.enabled=true

      # Database Configurations
      spring.datasource.url=file:/etc/secrets/spring.datasource.url
      spring.datasource.username=file:/etc/secrets/spring.datasource.username
      spring.datasource.password=file:/etc/secrets/spring.datasource.password
      spring.jpa.properties.hibernate.default_schema=file:/etc/secrets/spring.jpa.properties.hibernate.default_schema
      spring.jpa.properties.hibernate.ddl-auto=none
      spring.jpa.database-platform=org.hibernate.dialect.H2Dialect

      # Actuator Configurations
      management.endpoints.web.exposure.include=*
      management.endpoint.health.show-details=always
      management.endpoints.web.base-path=/
      management.endpoints.web.path-mapping.health=health-check
      management.endpoint.health.probes.enabled=true
      management.endpoint.health.group.readiness.include=db
      management.info.env.enabled=true
      management.endpoint.prometheus.enabled=false

      # Batch configuration
      batch.initial-delay.minutes=2
      batch.interval.minutes=240
      batch.shedlock-at-least=PT5M
      batch.shedlock-at-most=PT10M
      batch.enabled=false

      # Notifications Batch Configuration
      digital-assets-onboarding.notifications.batch.initial-delay.minutes=2
      digital-assets-onboarding.notifications.batch.interval.minutes=240
      digital-assets-onboarding.notifications.batch.shedlock-at-least=PT5M
      digital-assets-onboarding.notifications.batch.shedlock-at-most=PT10M
      digital-assets-onboarding.notifications.batch.enabled=false
      digital-assets-onboarding.notifications.batch.max-retry-attempts=3

      # Observability configurations
      observability.correlationIdHeader=x-correlation-id
      observability.tracerName=digital-assets-onboarding

      # Swagger Configuration
      springdoc.swagger-ui.path=/swagger-ui.html

      # Application Specific Configuration
      digital-assets-onboarding.activityLog.db-logging.enable=true

      # Middleware properties
      digital-assets-onboarding.client.middleware.updateCifUrl=http://localhost:9093/middleware/updateCif

      # NotificationService properties
      digital-assets-onboarding.client.notificationservice.notificationUrl=http://localhost:8096/digital-assets/notifications/api/v1/customer/{cif}

      # ProductEligibility properties
      digital-assets-onboarding.client.producteligibility.eligibilityUrl=http://localhost:8095/product-eligibility/api/v1/customer/{cif}

      # Retry Config
      digital-assets-onboarding.downstream.api.retry.max-attempts=3
      digital-assets-onboarding.downstream.api.retry.max-delay-ms=3000

# External Secrets #
externalsecrets:
  enabled: true
  name: digital-assets-onboarding-external-secrets
  secretStoreRef:
    name: aws-secrets-store
    kind: ClusterSecretStore
  target:
    name: /da-dev/digital-assets-onboarding
    creationPolicy: Owner
  data:
    # Database Secrets
    - secretKey: spring.datasource.url
      remoteRef:
        key: /da-dev/digital-assets-onboarding
        property: spring.datasource.url
    - secretKey: spring.datasource.username
      remoteRef:
        key: /da-dev/digital-assets-onboarding
        property: spring.datasource.username
    - secretKey: spring.datasource.password
      remoteRef:
        key: /da-dev/digital-assets-onboarding
        property: spring.datasource.password
    - secretKey: spring.jpa.properties.hibernate.default_schema
      remoteRef:
        key: /da-dev/digital-assets-onboarding
        property: spring.jpa.properties.hibernate.default_schema
